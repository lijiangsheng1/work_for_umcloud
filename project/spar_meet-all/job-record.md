## 2016.11.3 

早8点开始往北京西站赶，一路狂奔，终于在10:03分，离高铁开车还有7分钟的时间赶到了。一路无话，13:18到达太原南站，然后遵照代理商的指示到达平阳路，然后等到14点，用户开车送到 SPAR－美特好位于清徐的配送中心。

到达15:30，开始准备。

![](file:////Users/lijiansheng/Documents/UMCloud/项目/美特好超市/WechatIMG4.jpeg)

先是找了台联想的服务器，准备配置IPMI，安装FUEL。结果无法配置。只好换了台 Dell R710. 先是配置IPMI的IP地址，用户名、密码等，然后发现Mac下的JDK 8 无法登录 虚拟终端。

然后，尝试使用U盘来安装，还是哪个问题，kickstart脚本指定的CDROM：Lable＝live 无法用U盘。

然后，切换到虚拟机中的Ubuntu，使用icetea来，还是无法访问。

在此过程中，将所有6台机器的PXE网线插好！ 

这时时间已经指向6点钟，通勤车要返回市区，只好收拾东西返回。（用户并不乐意加班！）

吃完饭、checkin酒店，已经是八点半。为了明天能够顺利的完成部署，准备了以下几件事情：

1. 下载Mac下的JDK7版本
2. 按照良付的建议，也是良付提供的windows下的JDK7版本，安装到我的虚拟中。（万无一失）
3. 准备好Fuel9.0的本地安装步骤，如bootstrap制作、repo导入等等。


**特别感谢良付的大力支持。**

## 2016.11.4

代理商的网络配置工程师没有到位！独自战斗：

![](file:////Users/lijiansheng/Documents/UMCloud/项目/美特好超市/WechatIMG1.jpeg)

早上9点多到达，然后开始兴高采烈的启动Windows。最终发现Dell R710的iDrac6 是Express版，不支持虚拟控制台！！！

然后，再次抱着侥幸的心理试了两台联想完全的服务器，IPMI完全配置不了。好吧，找甲方刻录光盘！

联想的完全服务器是自带光驱的，其实根本就没法使。而且，使用外置光驱时，Fuel（CentOS7 anaconda）是识别正常的系统上的光驱的，而不是USB，所以无法安装，可能需要指定anaconda的参数。

只好继续安装在Dell R710上。

时间指向了10:30 。

**从光盘启动还是非常之慢的！**

10:50 开始配置fuel

配置的PXE 地址段为：192.168.10.0/24，修改Fuel admin密码为abc123

10:55 开始安装Fuel各种部件。

Dell需要什么特殊配置？ 内存只能识别1G，好吧！

浪潮的机器点不亮。

12:15 Fuel节点部署完毕，开始登录界面，然后配置bootstrap和本地repo。

12:20 在Fuel的界面上创建了一个叫做meet-all-cloud的环境。存储使用ceph。vlan网络

12:30 开始逐一引导各台slave机器。

 只能引导三台，剩余两台无法操作。一台是浪潮的，另外一台是联想的。
 
12:55 将其中三台机器部署好操作系统。然后测试网络

13:37 用户管理员在午休，我心存侥幸心理，部署一次试试。

14:00 果不其然，部署失败！

14:05 在交换机上划分VLAN。

## VLAN 及IP 段划分

| 网络类型 | 网络IP段 | VLAN |备注 |
| ------------ | ------------- | ------------ |------------ |
| iDrac(带外IPMI) |任意（如192.168.1.0/24）   | 无 |
| Admin/PXE | 10.1.0.0/24  | 100，untagged |
| Public及Floating IP | 10.10.7.0/24  |  103～110|
|management  | 10.10.8.0/24  |  101|
| storage |  192.168.1.0/24 | 102 |
| private |  192.168.111.0/24|  |
| Ironic |  |  | 无 |

14:35 不小心将电源给踢开了，交换机＋3台服务器都要重启。。

14:42 网络的哥们说刚才配置的交换机没有保存。重新再来一遍。

15:35 网络虽然验证通过，但是实际部署失败。其中一个网段的网关配置有问题。

![](file:////Users/lijiansheng/Documents/UMCloud/项目/美特好超市/WechatIMG3.jpeg)

等待中，远程支持的代理商网络工程师似乎有什么事情，或者是遇到什么难题，就是配不上，怎么地吧！

17:20 终于配置好了，但是Fuel的机器又挂了。。

![](file:////Users/lijiansheng/Documents/UMCloud/项目/美特好超市/WechatIMG2.jpeg)

17:25 更换内存条，故障依旧。

17:35 更换插槽，可以启动了。

17:40 可以确认现在的Fuel已经连接到meet－all的办公网络，使用10.10.7.100访问Fuel。也就是可以远程操作了。

17:45 离开机房，准备返回太原市区。
