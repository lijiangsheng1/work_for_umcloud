# 为云平台选择合适的应用负载

企业要从虚拟化转换到 OpenStack 云环境中，第一步要决定恐怕就是哪些应用程序先迁移。若是对形式的预估不准确、或者是准备不充分的话，那么导致的后果就是成本的增加和更多潜在的损失。

为了能够帮助用户做出正确的决定，我们在这里提供了一般的方法，确保用户可以成功的将应用迁移到 OpenStack 云平台中来，或者是在OpenStack 中实现新的应用项目：

1. 列出所有原有应用程序及其负载的细节：只有理解了具体的细节，才能够去决定哪些应用适合跑在什么样的环境中，是虚拟化环境，还是裸金属，还是容器化环境。
2. 根据负载特征,实现基于预期的选择标准，来将应用迁移或转换到 OpenStack 云平台中。
3. 然后根据证明过的架构来选择应用负载。
4. 衡量迁移到 OpenStack 的价值，要考虑周全了，短期、长期的以及有形和无形的价值都应该考虑。

## 应用特征

第一步，我们就是盘查、清点所有可以迁移到OpenStack环境中的应用，当然这也包括了寻找最适合OpenStack环境的应用。所有应用程序都应该针对不同的标准来确定在战略上和技术上可行的,然后将他们合理的迁移到OpenStack的环境中来。

即使是应用比较适合云平台，运维人员还需要就部署模式（虚拟机、裸金属、或者是容器）作出决定，这样的话就得考虑这些应用是否支持这三种形式。要从一些低风险的、模块化的应用程序开始，因为这些应用具备最小化的定制化数据、遗留接触点、敏感信息。或者说从一些本身就具备伸缩和自助服务的应用程序。

表5:最开始的时候，部署了OpenStack之后，可以上一些没有那么复杂的应用：

<dl>
<table style="width:100%">
  <tr>
    <th>独立的、没有那么复杂的应用程序</th>
    <th>关于此类应用的技术概念</th>
  </tr>
  <tr>
    <td>很少访问公司管理系统的数据库（如：web应用、基本的流）</td>
    <td rowspan="6">扩展范例：
      * 横向扩展
      * 每个应用的服务和组件都可以自动的、横向扩展
      *  模块化，松耦合的分布式应用架构，每个服务都有独立的API
      *  不共享任何内容的架构设计
      *  在应用层做弹性，而不是在基础设施层作文章。
      *  对于超时要去优雅的处理
      *  服务要提供双活的冗余
      *  使用分布式的存储
      *  对于基础设施和平台级的服务要持消费的态度
      *  在软件层完成数据的复制
      *  异步通信
      *  要使用通用的硬件来建构</td>
  </tr>
  <tr>
    <td>很少但需要大量计算资源,受益于弹性(如。批处理)</td>
  </tr>
  <tr>
    <td>运行在不同时区,受益于自助服务(例如面向内部的应用程序、季节性工作负载)</td>
  </tr>
  <tr>
    <td>运行的应用超过了它的预设的能力;从扩展中获益</td>
  </tr>
  <tr>
    <td>开发和测试（举例：定制应用）</td>
  </tr>
  <tr>
    <td>Back-office 应用（例如：email、项目管理、费用报告）</td>
  </tr>
</table>
</dl>

表6: 在适应了一段时间之后，可以部署的复杂应用：

<dl>
<table style="width:100%">
  <tr>
    <th>较复杂的应用，通常需要整合企业级的应用</th>
    <th>对于复杂应用的技术思考</th>
  </tr>
  <tr>
    <td>很少访问公司管理系统的数据库（如：web应用、基本的流）</td>
    <td rowspan="6">
    扩展类型：纵向扩展
、非常复杂和中心化的系统、
Big failure domains、
服务是由失效切换来保护的、
专用的服务器或虚拟机是由系统管理员手动维护的、
使用大型的SAN或持久化的存储、
使用很好的计算（或GPU）或是高速的SSD存储、
所有的基础设施组件都必须是100%可用的、
需要高性能的硬件来确保基础设施高可用、
</td>
  </tr>
  <tr>
    <td>高并发、大容量的事务处理数据库，难以迁移到云平台中。（例如：股票交易）</td>
  </tr>
  <tr>
    <td>资源密集型（内存、I/O）或者是需要特定的硬件需求，（例如：大数据、Hadoop、数据库）</td>
  </tr>
  <tr>
    <td>需要集成公司的信息管理数据库（例如：ERP、人力资源）</td>
  </tr>
  <tr>
    <td>高安全性和合规性需求（如：电子健康档案）</td>
  </tr>
  <tr>
    <td>性能敏感（如：业务智能）</td>
  </tr>
  <tr>
    <td>遗留平台或需要专门的硬件上运行（如：大型机、特殊加密的硬件)</td>
  </tr>
</table>
</dl>

## 选择标准

迁移传统的、静态的、monolithic的负载到基础设施即服务（IaaS）平台是一项颇具挑战性的任务。若要在IaaS平台下保证这些古老的程序的可用性的话，可能需要重构这些应用。当然也有一些选择的，比如仅仅是策略性的简单迁移，或者是干脆将整体的应用软件重构。

以下是我们提供的迁移到OpenStack云平台的策略：

* **重新部署** - 应用程序及其组件均不做任何的修改，重新部署和迁移。
* **云化** - 一些应用的迁移会使用云平台的资源或服务替换掉应用程序的组件和服务。比如平台即服务（PaaS）或软件即服务（SaaS）。
* **迁移时优化** - 应用程序需要重新部署，且需要修改以尽可能的满足云平台IaaS的功能和服务。

至于需要付出的代价，则要看迁移的策略和转型的副作用。迁移到OpenStack，代价是必须要付出的。所以，对于迁移应用到OpenStack环境的工作量预估和选择应用是一样的重要。

## 应用负载和OpenStack项目的依赖

在完成应用负载之前，还需要做一件事，那就是要对负载对依赖和OpenStack相关项目的成熟度做一个诊断。

在为OpenStack选择合适的应用负载的时候，其实已经决定了需要那些基础设施服务的。理解这些依赖可以帮助用户能够从应用负载需求和OpenStack平台功能之间作出最佳决策。OpenStack 社区在这方面可谓是经验丰富。请参考[项目导航](http://www.openstack.org/software/project-navigator)和[Sample Configurations](http://www.openstack.org/software/simple-configs)。

项目导航提供了OpenStack主要项目的信息，进一步帮助用户去决定如何选择软件，每个项目的选出均是由OpenStack技术委员会和用户委员会来最终决定的。评级的标准包括由：采用级别、成熟度、项目的具体年数。

基于OpenStack的用例和其现实世界的参考架构，配置样例是针对常见的应用所采用的核心项目和可选项目。这些信息对于应用负载能够在平台上运行是至关重要的。

可用的配置实例

* 高吞吐量的计算
* web 托管
* 公有云
* web服务和电子商务
* 创业公司
* 大数据
* 数据库即服务
* 视频处理和内容交付
* 容器优化

web 服务和电子商务的配置实例：

![](https://raw.githubusercontent.com/lijiangsheng1/work_for_umcloud/master/media/OpenStack_Core_project.png)

## 评估 OpenStack 的价值
作为颠覆现有IT文化的变革，证明OpenStack的架构先进性和体现的架构就显得非常的重要，另外要证明相比与原来的服务级别，基于云平台应用能够提供相同甚至更好的服务级别。这就要求我们衡量当前服务级别时，须以过去的服务级别为基准。计划服务中断是不可避免的,但可以合理的利用和改善服务水平。

这里给出一些企业进行比较时所使用的标准：

* 目标是提高虚拟化的百分比。
* 提高admin-to-server比率。
* 减少每虚拟机的费用。
* 减少整体的基础设施开销（通过上SaaS）。
* 增加（两倍或三倍)一定数量的应用。
* 能够加速交付基础设施的资源（用天或周来计算）。
* 使用灾难恢复的情况下，恢复业务的最终时间。
* 针对最终用户，改进的响应时间，
* 实现内部顾客的认同,是衡量增加部署的应用程序。

以上便是为OpenStack选择合适的应用程序的步骤和思考的内容了。接下来我们就实际的部署这些应用，从PoC阶段直到生产环境。
